#install.packages("BiocManager")
#BiocManager::install("limma")
#install.packages("locfit")
#BiocManager::install("edgeR")
library(limma)
library(edgeR)
inpD<-"F:/"
countTable = read.table(paste0(inpD,"count.thread12.tsv"),header=TRUE,row.names=1)
colnames(countTable)
condition = factor( c("AAG","AAG","WTCas9","AAG","WTCas9","WTCas9"))
des = model.matrix(~-1+condition)
colnames(des) = levels(condition)
cmat <- makeContrasts(WTCas9 - AAG, levels=des)
dge <- DGEList(counts=countTable)
dge <- calcNormFactors(dge)
v <- voom(dge,design=des)
fit <- lmFit(v,design=des)
fit <- contrasts.fit(fit, cmat)
fit <- eBayes(fit)
a <- decideTests(fit,adjust.method="fdr", p.value=0.05, lfc=0)
sma = summary(a)
dmm <- dim(countTable)
res <- topTable(fit,n=dmm[1],coef=1)
plot(res$logFC,-log10(res$adj.P.Val))
write.csv(res,file=paste0(inpD,"Voom_diffexp.csv"))
