---
runtime: shiny
output: html_document
---

```{r data}
inpF <-"L:/Animesh/Abba/dePep/proteinGroups.txt"
```

```{r mapped}
inpF <-"L:/Animesh/Abba/dePep/msmsScans.txt"
data <- read.delim(inpF, sep = "\t", header = T)
dataID = data[, grep("Identified", names(data))]
summary(dataID)
```
```{r mapped}
inpF <-"L:/Animesh/bug/ANOVA.txt"
data <- read.delim(inpF, sep = "\t", header = T, row.names = 24)
dataID = data[, grep("Column", names(data))]
summary(dataID)
```


```{r ANOVA}
factorC=c(rep("Group1",5),rep("Group2",5),rep("Group3",5),rep("Group4",5))
?TukeyHSD(aov((as.numeric(dataID[160,])~factorC)),"factorC", ordered = TRUE)
tc=apply(dataID,1,function(x){
#tc=apply(dataNorm, 1, function(x) 
#  tryCatch(TukeyHSD(aov(x~factorC,"factorC", ordered = TRUE)),error=function(x){return(rep(1,20))})})
  tryCatch(TukeyHSD(aov(x~factorC,"factorC")),error=function(x){return(rep(1,20))})})
outF = paste0(inpF,"anovaTukey.csv")
class(tc)
names(tc)
write.csv(tc, file=outF)
```

```{r summary}
data <- read.delim(inpF, row.names = 1, sep = "\t", header = T)
dataNorm = data[, grep("LFQ.intensity.", names(data))]
dataNorm = log2(dataNorm+1)
summary(dataNorm)
```

```{r custum, echo=FALSE}
inputPanel(
  sliderInput("bins", "#bins:", min = 1, max = 50, value = 30),
  textInput("dens", "Density:", "auto",value = 0.6), 
  selectInput("expression", label = "Sample:",choices = names(dataNorm), selected = names(dataNorm)[6]))
renderText({paste("Inputs:", input$bins,input$dens,input$expression)})
```

```{r plot, echo = FALSE}
#install.packages('shiny')
#library(shiny)
renderPlot({
  hist(dataNorm[,as.numeric(which(names(dataNorm)==input$expression))],breaks = as.numeric(input$bins),probability = TRUE,col="orange")
  lines(density(dataNorm[,as.numeric(which(names(dataNorm)==input$expression))], adjust = as.numeric(input$dens)),col="blue")
  })
```

