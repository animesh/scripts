---
runtime: shiny
output: 
  html_document:
    theme: darkly
    highlight: tango
---

```{r setup, echo = FALSE}
#libPaths="L:/promec/Animesh/R/win-library/4.0"
#.libPaths(c(libPaths, .libPaths()))
#install.packages("htmltools",lib=.libPaths()[1])
#knitr::opts_chunk$set(echo=F)
#library(shiny)
#install.packages("shinythemes")
#library(shinythemes)
#theme = shinythemes::shinytheme("darkly")
```


```{r data, echo = FALSE}
fName<-"proteinGroups.txt"
inpD <-"L:/promec/Qexactive/Mirta/CLN3/combined/txt/"
inpF<-paste0(inpD,fName)
data <- data.table::fread(inpF)
#data<-data[!data$Reverse=="+",]
#summary(data)
```

```{r select, echo = FALSE}
sel<-grep("LFQ",names(data))
dataHigh<-data[data$`Q-value`==0,]
dataHighNorm<-dataHigh[,..sel]
#summary(dataHighNorm)
dataHighNormLog2<-log2(dataHighNorm+1)
#dataHighNormLog2[is.na(dataHighNormLog2)]<-rnorm(1)
#summary(dataHighNormLog2)
hist(as.matrix(dataHighNormLog2))
```


```{r vennDiagram, echo = FALSE}
limma::vennDiagram(dataHighNormLog2[,1:5]>30)
#ggplot::ggsave(file=paste0(inpF,"venn.svg"),plot=vplot)#,  width=6, height=6)
```

```{r PCA, echo = FALSE}
log2LFQt<-t(dataHighNormLog2)
row.names(log2LFQt)<-colnames(dataHighNormLog2)
log2LFQtPCA<-prcomp(log2LFQt)
log2LFQtPCAsumm<-summary(log2LFQtPCA)
plot(prcomp(log2LFQt))
plot(log2LFQtPCA$x[,1], log2LFQtPCA$x[,2], pch = 16, col = factor(rownames(log2LFQt)),xlab = paste0("PC1 (", round(100*log2LFQtPCAsumm$importance[2,1],1), "%)"), ylab = paste0("PC2 (", round(100*log2LFQtPCAsumm$importance[2,2],1), "%)"),main=paste("PCA 1/2 with 0 containing proteinGroups imputed","\nProtein groups", dim(log2LFQt)[2],"across samples",dim(log2LFQt)[1]))
op <- par(cex = 1)
legend("bottomright", col = factor(rownames(log2LFQt)), legend = factor(rownames(log2LFQt)), pch = 16)
```

```{r react, echo = FALSE}
inputPanel(shiny::selectInput("lfq", label = "LFQ", choices = c(sel)))
output<-shiny::reactive({input$lfq})
```


