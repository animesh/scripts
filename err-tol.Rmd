```{r data-input}
tt <- "F:/promec/Gygi/b1947_293T_proteinID_11B_QE3_122212.pep.xml"
```

```{r pep-xml-read}
source("https://bioconductor.org/biocLite.R")
biocLite("pepXMLTab")
library("pepXMLTab")
tttt <- pepXML2tab(tt)
tttt[1,]
hist(as.numeric(tttt$massdiff))
```

```{r filter}
passed <- PSMfilter(tttt, pepFDR = 0.01, scorecolumn = 'spscore', hitrank = 1,minpeplen = 6, decoysuffix = '_REVERSED')
passed[1, ]
mdiff = as.numeric(passed$precursor_neutral_mass) - as.numeric(passed$calc_neutral_pep_mass)
dhist = hist(mdiff)
warnings()
hist(log10(dhist$density))
max(log10(dhist$density))

```



```{r de-gauss}
#https://cran.r-project.org/web/packages/mclust/vignettes/mclust.html
library(mclust)
mod4 = densityMclust(mdiff)
mod4$parameters$mean
summary(mod4)
plot(mod4, what = "BIC")
plot(mod4, what = "density")
plot(mod4, what = "diagnostic", type = "qq")
```



```{r write-output}
wtf = paste0(tt,"mu.txt")
write.table(mod4$parameters, wtf,sep = "\t")
```


