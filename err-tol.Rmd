<<<<<<< HEAD
```{r data-input}
tt <- "F:/promec/Gygi/b1947_293T_proteinID_11B_QE3_122212.pep.xml"
```

```{r pep-xml-read}
source("https://bioconductor.org/biocLite.R")
biocLite("pepXMLTab")
library("pepXMLTab")
tttt <- pepXML2tab(tt)
tttt[1,]
hist(as.numeric(tttt$massdiff))
```

```{r filter}
passed <- PSMfilter(tttt, pepFDR = 0.01, scorecolumn = 'spscore', hitrank = 1,minpeplen = 6, decoysuffix = '_REVERSED')
passed[1, ]
mdiff = as.numeric(passed$precursor_neutral_mass) - as.numeric(passed$calc_neutral_pep_mass)
dhist = hist(mdiff)
warnings()
hist(log10(dhist$density))
max(log10(dhist$density))

=======
```{r data}
#data=read.delim("F:/promec/Gygi/ftp.pride.ebi.ac.uk/pride//data//archive//2015//06//PXD001468/b1906_293T_proteinID_01A_QE3_122212_et.txt", skip = 1, header=T)
data=read.delim("L:/Elite/LARS/2015//desember/PD21/130814_frak5_monoQ_tod27/Set of 5 files_PSMsR.txt",header=T)
```

```{r hist}
#dhist=hist((data$exp_neutral_mass-data$calc_neutral_mass)/data$charge,breaks=50000,freq=F )
#warnings()
dhist=hist(data$Delta.mz.in.Da,breaks=100,freq=F)
hist(log10(dhist$density))
max(log10(dhist$density))
#min(abs(dhist$breaks[dhist$density>0.01]))
#plot(dhist$breaks[dhist$density>0.01])
>>>>>>> 5a47d3a967da86f33045855c65a09cad2a4104e5
```



```{r de-gauss}
#https://cran.r-project.org/web/packages/mclust/vignettes/mclust.html
<<<<<<< HEAD
library(mclust)
mod4 = densityMclust(mdiff)
mod4$parameters$mean
summary(mod4)
plot(mod4, what = "BIC")
plot(mod4, what = "density")
plot(mod4, what = "diagnostic", type = "qq")
```



```{r write-output}
wtf = paste0(tt,"mu.txt")
write.table(mod4$parameters, wtf,sep = "\t")
=======
install.packages('mclust')
library(mclust)
?mclust
#mod4 = densityMclust((data$exp_neutral_mass-data$calc_neutral_mass)/data$charge)
dmod4=(data$exp_neutral_mass-data$calc_neutral_mass)/data$charge
mod4 = densityMclust(data$Delta.mz.in.Da)
summary(mod4)
plot(mod4, what = "BIC")
dmod4=data$Delta.mz.in.Da
plot(mod4, what = "density", data = dmod4, breaks = 100)
plot(mod4, what = "diagnostic", type = "qq")
>>>>>>> 5a47d3a967da86f33045855c65a09cad2a4104e5
```

```{r ir}
i=0.9
n=1
y1<-0
y2<-0

for(x1 in seq(0.1, 10, 0.5)){
  for(x2 in seq(0.1, 10, 0.5)){
    y1<-c(((1-i)*n+x1)/((1-i)*n+x2),y1)
    y2<-c(x1/x2,y2)
  }
}
plot(log2(y1),log2(y2))
plot((y1),(y2))

```





