ayurP<-ayurP[2:20]
summary(ayurP)
y<-read.table(paste(pathD,toupper(typeF),"total",".txt",sep = ""),sep = "\t",header = T)
library(quantable)
row.names(y)<-y[,1]
y<-y[,-1]
summary(y)
y=merge(ayurP,y,by=0,all = TRUE)
row.names(y)<-y[,1]
y<-y[,-1]
y=robustscale(y)
y$data[is.na(y$data)]<-0
names(y$data)=sub("X","",names(y$data))
pheatmap(y$data,scale="row",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",fontsize_row=6,fontsize_col=6)
y<-read.table(paste(pathD,toupper(typeF),"total",".txt",sep = ""),sep = "\t",header = T)
y
paste(pathD,toupper(typeF),"total",".txt",sep = "")
ayurP<-read.table("F:/promec/Animesh/HeLa/ayu/new/Total Phylum.txt",header=T,sep="\t",row.names = 1)
summary(ayurP)
#y[is.na(y)]<-0
y=ayur
y=robustscale(y)
#y[is.na(y)]<-0
y=ayurP
y=robustscale(y)
names(y$data)=sub("X\\.","",names(y$data))
names(y$data)=sub("\\..*","",names(y$data))
summary(y)
pheatmap(y,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
y=robustscale(y)
#y[is.na(y)]<-0
y=ayurP
y
#y[is.na(y)]<-0
y=ayurP[2:21]
y
View(y)
#y[is.na(y)]<-0
y=ayurP[2:20]
names(y$data)=sub("X\\.","",names(y$data))
names(y$data)=sub("\\..*","",names(y$data))
summary(y)
#y[is.na(y)]<-0
y=ayurP[2:20]
y=robustscale(y)
names(y$data)=sub("X\\.","",names(y$data))
names(y$data)=sub("\\..*","",names(y$data))
summary(y)
pheatmap(y,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
summary(y$data)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
summary(y$data)
y=ayurP[2:20]
y[is.na(y)]<-0
y=robustscale(y)
names(y$data)=sub("X\\.","",names(y$data))
names(y$data)=sub("\\..*","",names(y$data))
summary(y$data)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
y=log2(ayurP[2:20])
y
y[is.na(y)]<-0
y=log2(ayurP[2:20]+1)
y[is.na(y)]<-0
y=robustscale(y)
names(y$data)=sub("X\\.","",names(y$data))
names(y$data)=sub("\\..*","",names(y$data))
summary(y$data)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
label<-read.table("F:/promec/Animesh/HeLa/ayu/new/class.txt",comment="D",header=T,sep="\t")
summary(label)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",annotation_col = label)
summary(label)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",annotation_col = label$Ayur)
summary(label)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",annotation_col = label)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
label
colnames(y$data)
label$Ayur
names(label)
rownames(label)
summary(label)
label$Name
label$Name=sub("-2","",label$Name)
label
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",annotation_col = label)
rowname(label)
rownames(label)
rownames(label)=label$Name
rownames(label)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",annotation_col = label)
#https://towardsdatascience.com/understanding-random-forest-58381e0602d2?source=email-51edc4174b8c-1563159702818-digest.reader------1-50------------------d9cb9616_bb31_4c68_a2d7_e8ff41773564-1
library(randomForest)
set.seed(100)
yyt=as.data.frame(y)
yyt
random_forest=randomForest(data=yyt,class~.,impurity='gini',ntree=200,replace=TRUE)
y$data
yyt=merge(y$data,label)
yyt
t(y$data)
yyt=merge(t(y$data),label)
yyt
t(y$data)
label$Ayur
label
yyt=merge(t(y$data),label$Ayur)
yyt
ow.names(y$data))
row.names(y$data))
row.names(t(y$data))
yyt=merge(t(y$data),label$Ayur, by.x = row.names(t(y$data)), by.y = "Ayur", all = TRUE)
yyt=merge(t(y$data),label, by.x = row.names(t(y$data)), by.y = "Ayur", all = TRUE)
colnames(y$data)
yyt=merge(t(y$data),label, by.x = colnames(y$data), by.y = "Ayur", all = TRUE)
yyt=merge((y$data),label, by.x = colnames(y$data), by.y = "Ayur", all = TRUE)
t(label)
yyt=merge((y$data),t(label), by.x = colnames(y$data), by.y = "Ayur", all = TRUE)
yyt=merge((y$data),t(label), by.x = colnames(y$data), all = TRUE)
yyt
yyt=merge(t(y$data),t(label), by.x = colnames(y$data), all = TRUE)
labelRF<-label[,-1]
labelRF
label[,-1]
label
labelRF<-label[,-1]
labelRF<-label[,-2]
labelRF<-label$Ayur
labelRF
rownames(labelRF)<-label$Name
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
View(labelRF)
yyt<-t(y)
yyt<-t(y$data)
View(yyt)
rbind(yyt,labelRF)
yyt<-as.data.frame(t(y$data))
rbind(yyt,labelRF)
merge(yyt,labelRF)
yyt<-as.data.frame(y$data)
t(
yyt<-as.data.frame(t(y$data))
yyt<-as.data.frame(y$data)
yyt<-as.data.frame(t(y$data))
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
View(labelRF)
merge(yyt,labelRF,by=0, all=TRUE)
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
random_forest=randomForest(data=yyt,label$Ayur~.,impurity='gini',ntree=200,replace=TRUE)
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
yyt<-as.data.frame(t(y$data))
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
View(yyt)
yyt[,-1]
yyt<-yyt[,-1]
random_forest=randomForest(data=yyt,label$Ayur~.,impurity='gini',ntree=200,replace=TRUE)
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=200,replace=TRUE)
colnames(yyt)
names(yyt)
names(yyt)<- gsub(" ", "_", names(yyt))
names(yyt)
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=200,replace=TRUE)
names(yyt)<- gsub("-", "__", names(yyt))
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=200,replace=TRUE)
print(random_forest)
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=1000,replace=TRUE)
print(random_forest)
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=100,replace=TRUE)
print(random_forest)
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=150,replace=TRUE)
print(random_forest)
legend("top",cex=0.8,legend=colnames(random_forest$err.rate),lty=c(1,2,3),col=c(1,2,3),horiz=T)
sort(importance(random_forest))
varImpPlot(random_forest)
# Chunk 1: data
pathD<-"F:/promec/Animesh/HeLa/Metagenome data analysis/Metagenome data analysis/"
typeF<-"phylum."
files<-list.files(path=pathD, pattern=typeF, full.names=TRUE, recursive=TRUE)
comb = data.frame(ID="_holder_",typeF=typeF,stringsAsFactors=F)#row.names(total)="bacteria"
for(i in files){
name=gsub(pathD, "", i)
print(name)
i1<-read.table(i,sep='\t')
i1<-t(i1)
colnames(i1)=c("ID",name)
i1df<-data.frame(i1,stringsAsFactors=F)
comb=merge(comb,i1df,by="ID",all = TRUE)
}
comb<-comb[-1,]
comb<-comb[,-2]
write.table(comb,paste(pathD,toupper(typeF),"total",".txt",sep = ""),sep = "\t",quote = FALSE,col.names = TRUE,row.names = FALSE)
# Chunk 2: data1
ayurP<-read.table("F:/promec/Animesh/HeLa/ayu/new/Total Phylum.txt",header=T,sep="\t",row.names = 1)
summary(ayurP)
ayurP<-ayurP[2:20]
ayurP[is.na(ayurP)]<-0
pheatmap(ayurP,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
# Chunk 3: label
label<-read.table("F:/promec/Animesh/HeLa/ayu/new/class.txt",comment="D",header=T,sep="\t")
summary(label)
label$Name=sub("-2","",label$Name)
rownames(label)=label$Name
# Chunk 4: data1
y=log2(ayurP[2:20]+1)
y[is.na(y)]<-0
y=robustscale(y)
names(y$data)=sub("X\\.","",names(y$data))
names(y$data)=sub("\\..*","",names(y$data))
summary(y$data)
colnames(y$data)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",annotation_col = label)
# Chunk 5: datacom
y<-read.table(paste(pathD,toupper(typeF),"total",".txt",sep = ""),sep = "\t",header = T)
library(quantable)
row.names(y)<-y[,1]
y<-y[,-1]
summary(y)
y=merge(ayurP,y,by=0,all = TRUE)
row.names(y)<-y[,1]
y<-y[,-1]
y=robustscale(y)
y$data[is.na(y$data)]<-0
names(y$data)=sub("X","",names(y$data))
pheatmap(y$data,scale="row",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",fontsize_row=6,fontsize_col=6)
# Chunk 6: scale
y<-read.table(paste(pathD,toupper(typeF),"total",".txt",sep = ""),sep = "\t",header = T)
#install.packages('quantable')
library(quantable)
row.names(y)<-y[,1]
y<-y[,-1]
#y<-as.matrix(unlist(y))
#y[is.na(y)]<-0
summary(y)
typeof(y)
y=robustscale(y)
y$data[is.na(y$data)]<-0
names(y$data)=sub("X","",names(y$data))
pheatmap(y$data,scale="row",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",fontsize_row=6)
# Chunk 7
otu <- read.csv("F:/promec/Results/Ani/Ayur/datanormalizationforotutable/Copy of OTU table.csv", stringsAsFactors=F)
species <- read.csv("C:/Users/animeshs/OneDrive - NTNU/ayurveda/species_div.csv",stringsAsFactors=T)
species <- read.csv("C:/Users/animeshs/OneDrive - NTNU/ayurveda/species_div_zscore_med.csv",stringsAsFactors=T)
summary(species$Species)
species$Escherichia.coli.K12
# Chunk 8
#https://towardsdatascience.com/understanding-random-forest-58381e0602d2?source=email-51edc4174b8c-1563159702818-digest.reader------1-50------------------d9cb9616_bb31_4c68_a2d7_e8ff41773564-1
library(randomForest)
set.seed(100)
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
yyt<-as.data.frame(t(y$data))
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
yyt<-yyt[,-1]
names(yyt)<- gsub(" ", "_", names(yyt))
names(yyt)<- gsub("-", "__", names(yyt))
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=150,replace=TRUE)
print(random_forest)
plot(random_forest)
legend("top",cex=0.8,legend=colnames(random_forest$err.rate),lty=c(1,2,3),col=c(1,2,3),horiz=T)
sort(importance(random_forest))
varImpPlot(random_forest)
#qplot(RCN1,GALNT2,data=yyt,colour=class,size=I(3))
# Chunk 9
library(rpart)
fit <- rpart(formula= Species ~ Eubacterium.rectale.ATCC.33656  + Dorea.longicatena.DSM.13814  + Prevotella.maculosa.OT.289 + Helicobacter.pullorum.MIT.98.5489 ,method="class", data=species,  control = rpart.control(cp = 1e-04))
fit <- rpart(Species ~ ., data=species, method="class", minsplit=2, minbucket=1)
fit <- rpart(Species ~ Eubacterium.rectale.ATCC.33656  + Escherichia.coli.K12+ Prevotella.maculosa.OT.289 + Helicobacter.pullorum.MIT.98.5489, data=species, method="class", minsplit=2, minbucket=1)
fit <- rpart(Species ~ Eubacterium.rectale.ATCC.33656  + Prevotella.maculosa.OT.289 , data=species, method="class", minsplit=2, minbucket=1)
printcp(fit)
plotcp(fit)
summary(fit)
plot(fit)
text(fit, use.n=TRUE, all=TRUE, cex=.6)
jpeg(fit, file = "C:/Users/animeshs/OneDrive - NTNU/ayurveda/tree.jpg")
pdf(fit, file = "C:/Users/animeshs/OneDrive - NTNU/ayurveda/tree.pdf")
prp(fit)
plot(1)
# Chunk 10
otu[1,]
plot(otu[,2])
hist(log2(otu[,2]))
# Chunk 11
#install.packages('party')
library(party)
k2p <- cforest( Kapha ~ Pita , data= otu, control=cforest_unbiased(mtry=2,ntree=50)) # fit the random forest
varimp(k2p)
#https://towardsdatascience.com/understanding-random-forest-58381e0602d2?source=email-51edc4174b8c-1563159702818-digest.reader------1-50------------------d9cb9616_bb31_4c68_a2d7_e8ff41773564-1
library(randomForest)
set.seed(100)
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
yyt<-as.data.frame(t(y$data))
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
yyt<-yyt[,-1]
names(yyt)<- gsub(" ", "_", names(yyt))
names(yyt)<- gsub("-", "__", names(yyt))
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=150,replace=TRUE)
print(random_forest)
plot(random_forest)
legend("top",cex=0.8,legend=colnames(random_forest$err.rate),lty=c(1,2,3),col=c(1,2,3),horiz=T)
sort(importance(random_forest))
varImpPlot(random_forest)
#qplot(RCN1,GALNT2,data=yyt,colour=class,size=I(3))
#https://towardsdatascience.com/understanding-random-forest-58381e0602d2?source=email-51edc4174b8c-1563159702818-digest.reader------1-50------------------d9cb9616_bb31_4c68_a2d7_e8ff41773564-1
library(randomForest)
#https://towardsdatascience.com/understanding-random-forest-58381e0602d2?source=email-51edc4174b8c-1563159702818-digest.reader------1-50------------------d9cb9616_bb31_4c68_a2d7_e8ff41773564-1
library(randomForest)
set.seed(100)
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
yyt<-as.data.frame(t(y$data))
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
yyt<-yyt[,-1]
names(yyt)<- gsub(" ", "_", names(yyt))
names(yyt)<- gsub("-", "__", names(yyt))
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=150,replace=TRUE)
print(random_forest)
plot(random_forest)
legend("top",cex=0.8,legend=colnames(random_forest$err.rate),lty=c(1,2,3),col=c(1,2,3),horiz=T)
sort(importance(random_forest))
varImpPlot(random_forest)
#qplot(RCN1,GALNT2,data=yyt,colour=class,size=I(3))
set.seed(100)
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
yyt<-as.data.frame(t(y$data))
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
yyt<-yyt[,-1]
names(yyt)<- gsub(" ", "_", names(yyt))
names(yyt)<- gsub("-", "__", names(yyt))
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=150,replace=TRUE)
ayurP<-read.table("F:/promec/Animesh/HeLa/ayu/new/Total Phylum.txt",header=T,sep="\t",row.names = 1)
summary(ayurP)
ayurP<-ayurP[2:20]
ayurP[is.na(ayurP)]<-0
pheatmap(ayurP,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
library(pheatmap)
ayurP<-read.table("F:/promec/Animesh/HeLa/ayu/new/Total Phylum.txt",header=T,sep="\t",row.names = 1)
summary(ayurP)
ayurP<-ayurP[2:20]
ayurP[is.na(ayurP)]<-0
pheatmap(ayurP,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
label<-read.table("F:/promec/Animesh/HeLa/ayu/new/class.txt",comment="D",header=T,sep="\t")
summary(label)
label$Name=sub("-2","",label$Name)
rownames(label)=label$Name
summary(label)
y=log2(ayurP[2:20]+1)
y[is.na(y)]<-0
y=robustscale(y)
names(y$data)=sub("X\\.","",names(y$data))
names(y$data)=sub("\\..*","",names(y$data))
summary(y$data)
colnames(y$data)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",annotation_col = label)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",annotation_col = label)
y=log2(ayurP[2:20]+1)
y[is.na(y)]<-0
y=robustscale(y)
names(y$data)=sub("X\\.","",names(y$data))
names(y$data)=sub("\\..*","",names(y$data))
summary(y$data)
colnames(y$data)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
y<-read.table(paste(pathD,toupper(typeF),"total",".txt",sep = ""),sep = "\t",header = T)
library(quantable)
row.names(y)<-y[,1]
y<-y[,-1]
summary(y)
y=merge(ayurP,y,by=0,all = TRUE)
row.names(y)<-y[,1]
y<-y[,-1]
y=robustscale(y)
y$data[is.na(y$data)]<-0
names(y$data)=sub("X","",names(y$data))
pheatmap(y$data,scale="row",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",fontsize_row=6,fontsize_col=6)
y<-read.table(paste(pathD,toupper(typeF),"total",".txt",sep = ""),sep = "\t",header = T)
#install.packages('quantable')
library(quantable)
row.names(y)<-y[,1]
y<-y[,-1]
#y<-as.matrix(unlist(y))
#y[is.na(y)]<-0
summary(y)
typeof(y)
y=robustscale(y)
y$data[is.na(y$data)]<-0
names(y$data)=sub("X","",names(y$data))
pheatmap(y$data,scale="row",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",fontsize_row=6)
#https://towardsdatascience.com/understanding-random-forest-58381e0602d2?source=email-51edc4174b8c-1563159702818-digest.reader------1-50------------------d9cb9616_bb31_4c68_a2d7_e8ff41773564-1
library(randomForest)
set.seed(100)
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
yyt<-as.data.frame(t(y$data))
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
yyt<-yyt[,-1]
names(yyt)<- gsub(" ", "_", names(yyt))
names(yyt)<- gsub("-", "__", names(yyt))
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=150,replace=TRUE)
print(random_forest)
plot(random_forest)
legend("top",cex=0.8,legend=colnames(random_forest$err.rate),lty=c(1,2,3),col=c(1,2,3),horiz=T)
sort(importance(random_forest))
varImpPlot(random_forest)
#qplot(RCN1,GALNT2,data=yyt,colour=class,size=I(3))
library(randomForest)
set.seed(100)
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
yyt<-as.data.frame(t(y$data))
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
yyt<-yyt[,-1]
names(yyt)<- gsub(" ", "_", names(yyt))
names(yyt)<- gsub("-", "__", names(yyt))
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=150,replace=TRUE)
print(random_forest)
plot(random_forest)
legend("top",cex=0.8,legend=colnames(random_forest$err.rate),lty=c(1,2,3),col=c(1,2,3),horiz=T)
sort(importance(random_forest))
varImpPlot(random_forest)
#qplot(RCN1,GALNT2,data=yyt,colour=class,size=I(3))
library(randomForest)
library(randomForest)
set.seed(100)
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
yyt<-as.data.frame(t(y$data))
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
yyt<-yyt[,-1]
names(yyt)<- gsub(" ", "_", names(yyt))
names(yyt)<- gsub("-", "__", names(yyt))
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=150,replace=TRUE)
print(random_forest)
plot(random_forest)
legend("top",cex=0.8,legend=colnames(random_forest$err.rate),lty=c(1,2,3),col=c(1,2,3),horiz=T)
sort(importance(random_forest))
varImpPlot(random_forest)
#qplot(RCN1,GALNT2,data=yyt,colour=class,size=I(3))
y<-read.table(paste(pathD,toupper(typeF),"total",".txt",sep = ""),sep = "\t",header = T)
#install.packages('quantable')
library(quantable)
row.names(y)<-y[,1]
y<-y[,-1]
#y<-as.matrix(unlist(y))
#y[is.na(y)]<-0
summary(y)
typeof(y)
y=robustscale(y)
y$data[is.na(y$data)]<-0
names(y$data)=sub("X","",names(y$data))
pheatmap(y$data,scale="row",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",fontsize_row=6)
y=log2(ayurP[2:20]+1)
y[is.na(y)]<-0
y=robustscale(y)
names(y$data)=sub("X\\.","",names(y$data))
names(y$data)=sub("\\..*","",names(y$data))
summary(y$data)
colnames(y$data)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
#install.packages('quantable')
library(quantable)
row.names(y)<-y[,1]
y<-y[,-1]
#y<-as.matrix(unlist(y))
#y[is.na(y)]<-0
summary(y)
typeof(y)
y=robustscale(y)
y$data[is.na(y$data)]<-0
names(y$data)=sub("X","",names(y$data))
pheatmap(y$data,scale="row",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation",fontsize_row=6)
y=log2(ayurP[2:20]+1)
y[is.na(y)]<-0
y=robustscale(y)
names(y$data)=sub("X\\.","",names(y$data))
names(y$data)=sub("\\..*","",names(y$data))
summary(y$data)
colnames(y$data)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
library(randomForest)
set.seed(100)
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
yyt<-as.data.frame(t(y$data))
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
yyt<-yyt[,-1]
names(yyt)<- gsub(" ", "_", names(yyt))
names(yyt)<- gsub("-", "__", names(yyt))
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=150,replace=TRUE)
print(random_forest)
plot(random_forest)
legend("top",cex=0.8,legend=colnames(random_forest$err.rate),lty=c(1,2,3),col=c(1,2,3),horiz=T)
sort(importance(random_forest))
varImpPlot(random_forest)
#qplot(RCN1,GALNT2,data=yyt,colour=class,size=I(3))
library(randomForest)
set.seed(100)
labelRF<-as.data.frame(label$Ayur)
rownames(labelRF)<-label$Name
yyt<-as.data.frame(t(y$data))
yyt<-merge(yyt,labelRF,by=0, all=TRUE)
yyt<-yyt[,-1]
names(yyt)<- gsub(" ", "_", names(yyt))
names(yyt)<- gsub("-", "__", names(yyt))
random_forest=randomForest(data=yyt,yyt$`label$Ayur`~.,impurity='gini',ntree=150,replace=TRUE)
pheatmap(y$data,scale="column",clustering_distance_rows = "correlation",clustering_distance_cols = "correlation")
